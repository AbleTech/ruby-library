

<!DOCTYPE html>
<!--[if IE 8]><html class="no-js lt-ie9" lang="en" > <![endif]-->
<!--[if gt IE 8]><!--> <html class="no-js" lang="en" > <!--<![endif]-->
<head>
  
  <link href='https://fonts.googleapis.com/css?family=Open+Sans:300,400,600,700,800' rel='stylesheet' type='text/css'>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  
  <title>Defining and Sending Push Notifications &mdash; Urban Airship Python Library 0.7.3 documentation</title>
  

  
  

  
  
    

  

  
  
    <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  
    <link rel="top" title="Urban Airship Python Library 0.7.3 documentation" href="index.html"/>
        <link rel="next" title="Retrieving Device Information" href="devices.html"/>
        <link rel="prev" title="Urban Airship Python Library" href="index.html"/> 

  
  <script src="https://cdnjs.cloudflare.com/ajax/libs/modernizr/2.6.2/modernizr.min.js"></script>

</head>

<body class="detail" role="document">
  <header class="header fixed">
  <h1 class="logo">
    <a href="index.html" title="Urban Airship">Urban Airship</a>
    <!--<a href="index.html" title="Urban Airship">Urban Airship</a>-->
  </h1>
  <a href="#" id="menu-toggle" class="icon-list"></a>
  <a href="#" id="search-toggle" class="icon-search"></a>
  <div class="main-nav-wrap" id="main-nav-wrap">
    <div class="main-nav-inner">
      <nav class="primary">
        <ul class="main-menu">
          <li>
            <a href="#">Platforms</a>
            <ul class="submenu">
              <li><a href="platform/ios.html"><span>iOS</span></a></li>
              <li><a href="platform/android.html"><span>Android</span></a></li>
              <li><a href="platform/blackberry.html"><span>BlackBerry</span></a></li>
              <li><a href="platform/windows.html"><span>Windows</span></a></li>
              <li><a href="platform/phonegap.html"><span>PhoneGap</span></a></li>
            </ul>
          </li>
          <li>
            <a href="#">APIs</a>
            <ul class="submenu">
              <li><a href="integration.html"><span>Integration</span></a></li>
              <li><a href="api/overview.html"><span>API Overview</span></a></li>
              <li><a href="api/ua.html"><span>API Reference</span></a></li>
            </ul>
          </li>
          <li>
             <a href="#">User Guide</a>
             <ul class="submenu">
               <li><a href="user-guide/getting-started.html"><span>Getting Started</span></a></li>
               <li><a href="user-guide/message-composer.html"><span>Messaging</span></a></li>
               <li><a href="user-guide/audience.html"><span>Audience</span></a></li>
               <li><a href="user-guide/reports.html"><span>Reports</span></a></li>
               <li><a href="user-guide/settings.html"><span>Settings</span></a></li>
               <li><a href="user-guide/account.html"><span>Account</span></a></li>
             </ul>
          </li>
          <li>
            <a href="#">Wallet Studio</a>
            <ul class="submenu">
              <li><a href="wallet-studio/getting-started.html"><span>Getting Started</span></a></li>
              <li><a href="wallet-studio/reference.html"><span>Reference</span></a></li>
              <li><a href="api/wallet.html"><span>API</span></a></li>
            </ul>
          </li>
          <li><a href="topic-guides/index.html">Topic Guides</a></li>
          <li><a href="reference/index.html">Reference</a></li>
          <li class="hide-on-small"><a href="whats-new/index.html">What's New</a></li>
        </ul>
      </nav>
    </div>
  </div>
  <div class="search-wrapper">
<script>
  (function() {
    var cx = '003987891287610372151:8d55aluonec';
    var gcse = document.createElement('script');
    gcse.type = 'text/javascript';
    gcse.async = true;
    gcse.src = (document.location.protocol == 'https:' ? 'https:' : 'http:') +
        '//www.google.com/cse/cse.js?cx=' + cx;
    var s = document.getElementsByTagName('script')[0];
    s.parentNode.insertBefore(gcse, s);
  })();
</script>
<style>
.gsc-control-cse {
    background: #015172;
    border: 0;
    border-left: 1px solid #015172;
}
.gsc-control-cse div {
    margin-top: 2px;
}
.gsc-input-box {
    border: 0;
    background: #015172;
}
.gsc-input input.gsc-input {
    background: #f5f5f5 !important;
    border-radius: 0; 
}
.gsc-input input.gsc-input:focus {
    background: #FFFFFF !important;
}
input.gsc-search-button-v2 {
    width: 13px;
    height: 13px;
    padding: 4px 12px;
    min-width: 13px;
    margin-top: 2px;
}
.gsc-search-box-tools .gsc-search-box .gsc-input {
    padding-right: 0;
}

.gsib_a, .gsib_b {
    padding: 0;
}

input.gsc-search-button {
    border: 0;
    background-color: #51c4cc;
}

</style>
<gcse:search></gcse:search>
  </div>
</header>
<div id="mobile-toc">
  <a id="toc-toggle">Table of Contents</a>
</div>

  <div class="content">

    
    <aside id="side-nav" class="sidebar-first">

      <!-- Local TOC -->
      <nav class="toc">
        <div class="local-toc"><ul>
<li><a class="reference internal" href="#">Defining and Sending Push Notifications</a><ul>
<li><a class="reference internal" href="#audience-selectors">Audience Selectors</a></li>
<li><a class="reference internal" href="#notification-payload">Notification Payload</a></li>
<li><a class="reference internal" href="#actions">Actions</a></li>
<li><a class="reference internal" href="#interactive-notifications">Interactive Notifications</a></li>
<li><a class="reference internal" href="#device-types">Device Types</a></li>
<li><a class="reference internal" href="#delivery">Delivery</a></li>
<li><a class="reference internal" href="#scheduled-delivery">Scheduled Delivery</a></li>
<li><a class="reference internal" href="#scheduled-delivery-in-device-local-time">Scheduled Delivery in Device Local Time</a></li>
<li><a class="reference internal" href="#updating-or-canceling-a-schedule">Updating or Canceling a Schedule</a></li>
</ul>
</li>
</ul>
</div>
      </nav>
        <footer>
  <div class="legal" role="contentinfo">
  	<p>
  	    &copy; Copyright 2015, Urban Airship.
  	</p>
  	<a href="http://urbanairship.com/legal/privacy-policy" target="_blank">Privacy Policy</a>
  </div>
</footer>
      
    </aside>

    <div class="main-content">

      <div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="breadcrumbs">
    <li><a href="index.html">Docs</a> &raquo;</li>
      
    <li>Defining and Sending Push Notifications</li>
  </ul>
</div>

      
      <div role="main" class="document">
        
  <div class="section" id="defining-and-sending-push-notifications">
<h1>Defining and Sending Push Notifications<a class="headerlink" href="#defining-and-sending-push-notifications" title="Permalink to this headline">¶</a></h1>
<p>The Urban Airship Python Library strives to match the standard Urban
Airship JSON format for specifying push notifications. When creating a
push notification, you:</p>
<ol class="arabic simple">
<li>Select the audience</li>
<li>Define the notification payload</li>
<li>Specify device types.</li>
<li>Deliver the notification.</li>
</ol>
<p>This example performs a broadcast with the same alert to all recipients
and device types:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">urbanairship</span> <span class="kn">as</span> <span class="nn">ua</span>
<span class="n">airship</span> <span class="o">=</span> <span class="n">ua</span><span class="o">.</span><span class="n">Airship</span><span class="p">(</span><span class="n">app_key</span><span class="p">,</span> <span class="n">master_secret</span><span class="p">)</span>

<span class="n">push</span> <span class="o">=</span> <span class="n">airship</span><span class="o">.</span><span class="n">create_push</span><span class="p">()</span>
<span class="n">push</span><span class="o">.</span><span class="n">audience</span> <span class="o">=</span> <span class="n">ua</span><span class="o">.</span><span class="n">all_</span>
<span class="n">push</span><span class="o">.</span><span class="n">notification</span> <span class="o">=</span> <span class="n">ua</span><span class="o">.</span><span class="n">notification</span><span class="p">(</span><span class="n">alert</span><span class="o">=</span><span class="s">&quot;Hello, world!&quot;</span><span class="p">)</span>
<span class="n">push</span><span class="o">.</span><span class="n">device_types</span> <span class="o">=</span> <span class="n">ua</span><span class="o">.</span><span class="n">all_</span>
<span class="n">push</span><span class="o">.</span><span class="n">send</span><span class="p">()</span>
</pre></div>
</div>
<div class="section" id="audience-selectors">
<h2>Audience Selectors<a class="headerlink" href="#audience-selectors" title="Permalink to this headline">¶</a></h2>
<p>An audience should specify one or more devices. An audience can be a
device, such as a <code class="docutils literal"><span class="pre">channel</span></code>, <code class="docutils literal"><span class="pre">device_token</span></code> or <code class="docutils literal"><span class="pre">apid</span></code>; a tag,
alias, or segment; a location; or a combination. Audience selectors are
combined with <code class="docutils literal"><span class="pre">and_</span></code>, <code class="docutils literal"><span class="pre">or_</span></code>, and <code class="docutils literal"><span class="pre">not_</span></code>.</p>
<dl class="data">
<dt id="urbanairship.push.all_">
<code class="descclassname">urbanairship.push.</code><code class="descname">all_</code><a class="headerlink" href="#urbanairship.push.all_" title="Permalink to this definition">¶</a></dt>
<dd><p>Select all, to do a broadcast.</p>
<p>Used in both <code class="docutils literal"><span class="pre">audience</span></code> and <code class="docutils literal"><span class="pre">device_types</span></code>.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">push</span><span class="o">.</span><span class="n">audience</span> <span class="o">=</span> <span class="n">ua</span><span class="o">.</span><span class="n">all_</span>
</pre></div>
</div>
</dd></dl>

</div>
<div class="section" id="notification-payload">
<h2>Notification Payload<a class="headerlink" href="#notification-payload" title="Permalink to this headline">¶</a></h2>
<p>The notification payload determines what message and data is sent to a
device. At its simplest, it consists of a single string-valued
attribute, &#8220;alert&#8221;, which sends a push notification consisting of a
single piece of text:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">push</span><span class="o">.</span><span class="n">notification</span> <span class="o">=</span> <span class="n">ua</span><span class="o">.</span><span class="n">notification</span><span class="p">(</span><span class="n">alert</span><span class="o">=</span><span class="s">&quot;Hello, world!&quot;</span><span class="p">)</span>
</pre></div>
</div>
<p>You can override the payload with platform-specific values as well.</p>
</div>
<div class="section" id="actions">
<h2>Actions<a class="headerlink" href="#actions" title="Permalink to this headline">¶</a></h2>
<p>Urban Airship Actions provides a convenient way to automatically
perform tasks by name in response to push notifications,
Rich App Page interactions and JavaScript. More information at
<a class="reference external" href="http://docs.urbanairship.com/api/ua.html#actions">http://docs.urbanairship.com/api/ua.html#actions</a>, example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">push</span><span class="o">.</span><span class="n">notification</span> <span class="o">=</span> <span class="n">ua</span><span class="o">.</span><span class="n">notification</span><span class="p">(</span>
       <span class="n">alert</span><span class="o">=</span><span class="s">&quot;Hello, world!&quot;</span><span class="p">,</span>
       <span class="n">actions</span><span class="o">=</span><span class="n">ua</span><span class="o">.</span><span class="n">actions</span><span class="p">(</span>
           <span class="n">add_tag</span><span class="o">=</span><span class="s">&quot;new_tag&quot;</span><span class="p">,</span>
           <span class="n">remove_tag</span><span class="o">=</span><span class="s">&quot;old_tag&quot;</span><span class="p">,</span>
           <span class="n">share</span><span class="o">=</span><span class="s">&quot;Check out Urban Airship!&quot;</span><span class="p">,</span>
           <span class="n">open_</span><span class="o">=</span><span class="p">{</span>
               <span class="s">&quot;type&quot;</span><span class="p">:</span> <span class="s">&quot;url&quot;</span><span class="p">,</span>
               <span class="s">&quot;content&quot;</span><span class="p">:</span> <span class="s">&quot;http://www.urbanairship.com&quot;</span>
           <span class="p">},</span>
           <span class="n">app_defined</span><span class="o">=</span><span class="p">{</span>
               <span class="s">&quot;some_app_defined_action&quot;</span><span class="p">:</span> <span class="s">&quot;some_values&quot;</span>
           <span class="p">}</span>
       <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="interactive-notifications">
<h2>Interactive Notifications<a class="headerlink" href="#interactive-notifications" title="Permalink to this headline">¶</a></h2>
<p>The interactive notification payload determines the ways you can interact
with a notification. It contains two attributes: &#8220;type&#8221; (mandatory) and
&#8220;button_actions&#8221; (optional). More information at
<a class="reference external" href="http://docs.urbanairship.com/api/ua.html#interactive-notifications">http://docs.urbanairship.com/api/ua.html#interactive-notifications</a>
Example:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">push</span><span class="o">.</span><span class="n">notification</span> <span class="o">=</span> <span class="n">ua</span><span class="o">.</span><span class="n">notification</span><span class="p">(</span>
    <span class="n">alert</span><span class="o">=</span><span class="s">&quot;Hello, world!&quot;</span><span class="p">,</span>
    <span class="n">interactive</span><span class="o">=</span><span class="n">ua</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span>
        <span class="nb">type</span> <span class="o">=</span> <span class="s">&quot;ua_share&quot;</span><span class="p">,</span>
        <span class="n">button_actions</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s">&quot;share&quot;</span> <span class="p">:</span> <span class="p">{</span> <span class="s">&quot;share&quot;</span> <span class="p">:</span> <span class="s">&quot;Sharing is caring!&quot;</span><span class="p">}</span>
        <span class="p">}</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
<p>Button actions can also be mapped to <em>actions</em> objects as shown below:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">shared</span> <span class="o">=</span> <span class="n">ua</span><span class="o">.</span><span class="n">actions</span><span class="p">(</span><span class="n">share</span><span class="o">=</span><span class="s">&quot;Sharing is caring!&quot;</span><span class="p">)</span>
<span class="n">push</span><span class="o">.</span><span class="n">notification</span> <span class="o">=</span> <span class="n">ua</span><span class="o">.</span><span class="n">notification</span><span class="p">(</span>
    <span class="n">alert</span><span class="o">=</span><span class="s">&quot;Hello, world!&quot;</span><span class="p">,</span>
    <span class="n">interactive</span><span class="o">=</span><span class="n">ua</span><span class="o">.</span><span class="n">interactive</span><span class="p">(</span>
        <span class="nb">type</span> <span class="o">=</span> <span class="s">&quot;ua_share&quot;</span><span class="p">,</span>
        <span class="n">button_actions</span> <span class="o">=</span> <span class="p">{</span>
                <span class="s">&quot;share&quot;</span> <span class="p">:</span> <span class="n">shared</span>
        <span class="p">}</span>
    <span class="p">)</span>
<span class="p">)</span>
</pre></div>
</div>
</div>
<div class="section" id="device-types">
<h2>Device Types<a class="headerlink" href="#device-types" title="Permalink to this headline">¶</a></h2>
<p>In addition to specifying the audience, you must specify the device
types you wish to target, either with a list of strings:</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">push</span><span class="o">.</span><span class="n">device_types</span> <span class="o">=</span> <span class="n">ua</span><span class="o">.</span><span class="n">device_types</span><span class="p">(</span><span class="s">&#39;ios&#39;</span><span class="p">,</span> <span class="s">&#39;blackberry&#39;</span><span class="p">)</span>
</pre></div>
</div>
<p>or with the <code class="docutils literal"><span class="pre">all_</span></code> shortcut.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">push</span><span class="o">.</span><span class="n">device_types</span> <span class="o">=</span> <span class="n">ua</span><span class="o">.</span><span class="n">all_</span>
</pre></div>
</div>
</div>
<div class="section" id="delivery">
<h2>Delivery<a class="headerlink" href="#delivery" title="Permalink to this headline">¶</a></h2>
<p>Once you have set the <code class="docutils literal"><span class="pre">audience</span></code>, <code class="docutils literal"><span class="pre">notification</span></code>, and <code class="docutils literal"><span class="pre">device_types</span></code>
attributes, the notification is ready for delivery.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">push</span><span class="o">.</span><span class="n">send</span><span class="p">()</span>
</pre></div>
</div>
<p>If the delivery is unsuccessful, an <code class="xref py py-class docutils literal"><span class="pre">AirshipFailure</span></code> exception
will be raised.</p>
</div>
<div class="section" id="scheduled-delivery">
<h2>Scheduled Delivery<a class="headerlink" href="#scheduled-delivery" title="Permalink to this headline">¶</a></h2>
<p>Scheduled notifications build upon the Push object, and have two other
components: the scheduled time(s) and an optional name.</p>
<p>This example schedules the above notification for delivery in one
minute.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">datetime</span>

<span class="n">schedule</span> <span class="o">=</span> <span class="n">airship</span><span class="o">.</span><span class="n">create_scheduled_push</span><span class="p">()</span>
<span class="n">schedule</span><span class="o">.</span><span class="n">push</span> <span class="o">=</span> <span class="n">push</span>
<span class="n">schedule</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;optional name for later reference&quot;</span>
<span class="n">schedule</span><span class="o">.</span><span class="n">schedule</span> <span class="o">=</span> <span class="n">ua</span><span class="o">.</span><span class="n">scheduled_time</span><span class="p">(</span>
    <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">minutes</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">schedule</span><span class="o">.</span><span class="n">send</span><span class="p">()</span>

<span class="k">print</span> <span class="p">(</span><span class="s">&quot;Created schedule. url:&quot;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">schedule_url</span><span class="p">)</span>
</pre></div>
</div>
<p>If the schedule is unsuccessful, an <code class="xref py py-class docutils literal"><span class="pre">AirshipFailure</span></code>
exception will be raised.</p>
</div>
<div class="section" id="scheduled-delivery-in-device-local-time">
<h2>Scheduled Delivery in Device Local Time<a class="headerlink" href="#scheduled-delivery-in-device-local-time" title="Permalink to this headline">¶</a></h2>
<p>Scheduled notifications build upon the Push object, and have two other
components: the scheduled time(s) and an optional name.</p>
<p>This example schedules the above notification for delivery in device
local time.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="kn">import</span> <span class="nn">datetime</span>

<span class="n">schedule</span> <span class="o">=</span> <span class="n">airship</span><span class="o">.</span><span class="n">create_scheduled_push</span><span class="p">()</span>
<span class="n">schedule</span><span class="o">.</span><span class="n">push</span> <span class="o">=</span> <span class="n">push</span>
<span class="n">schedule</span><span class="o">.</span><span class="n">name</span> <span class="o">=</span> <span class="s">&quot;optional name for later reference&quot;</span>
<span class="n">schedule</span><span class="o">.</span><span class="n">schedule</span> <span class="o">=</span> <span class="n">ua</span><span class="o">.</span><span class="n">local_scheduled_time</span><span class="p">(</span>
    <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="p">(</span><span class="mi">2015</span><span class="p">,</span> <span class="mi">4</span><span class="p">,</span> <span class="mi">1</span><span class="p">,</span> <span class="mi">8</span><span class="p">,</span> <span class="mi">5</span><span class="p">))</span>
<span class="n">response</span> <span class="o">=</span> <span class="n">schedule</span><span class="o">.</span><span class="n">send</span><span class="p">()</span>

<span class="k">print</span> <span class="p">(</span><span class="s">&quot;Created schedule. url:&quot;</span><span class="p">,</span> <span class="n">response</span><span class="o">.</span><span class="n">schedule_url</span><span class="p">)</span>
</pre></div>
</div>
<p>If the schedule is unsuccessful, an <code class="xref py py-class docutils literal"><span class="pre">AirshipFailure</span></code> exception
will be raised.</p>
</div>
<div class="section" id="updating-or-canceling-a-schedule">
<h2>Updating or Canceling a Schedule<a class="headerlink" href="#updating-or-canceling-a-schedule" title="Permalink to this headline">¶</a></h2>
<p>If you have the <code class="docutils literal"><span class="pre">schedule_url</span></code> returned from creating a scheduled
notification, you can update or cancel it before it&#8217;s sent.</p>
<div class="highlight-python"><div class="highlight"><pre><span class="n">schedule</span> <span class="o">=</span> <span class="n">ua</span><span class="o">.</span><span class="n">ScheduledPush</span><span class="o">.</span><span class="n">from_url</span><span class="p">(</span><span class="n">airship</span><span class="p">,</span> <span class="n">url</span><span class="p">)</span>
<span class="c"># change scheduled time to tomorrow</span>
<span class="n">schedule</span><span class="o">.</span><span class="n">schedule</span> <span class="o">=</span> <span class="n">ua</span><span class="o">.</span><span class="n">scheduled_time</span><span class="p">(</span>
    <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">utcnow</span><span class="p">()</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">days</span><span class="o">=</span><span class="mi">1</span><span class="p">))</span>
<span class="n">schedule</span><span class="o">.</span><span class="n">update</span><span class="p">()</span>

<span class="c"># Cancel</span>
<span class="n">schedule</span><span class="o">.</span><span class="n">cancel</span><span class="p">()</span>
</pre></div>
</div>
</div>
</div>


      </div>
    </div>

  </div>


  <script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/2.1.1/jquery.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/waypoints/2.0.4/waypoints.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/waypoints/2.0.5/shortcuts/sticky-elements/waypoints-sticky.min.js"></script>
  <script type="text/javascript" src="_static/sphinxcontrib-images/Lightbox2/lightbox2/js/lightbox.min.js"></script>
  <script type="text/javascript" src="_static/js/theme.js"></script>
  <script type="text/javascript" src="_static/js/primary-nav.js"></script>
  <script type="text/javascript" src="_static/js/lazyload.js"></script>

  <script>
    var menu = new cbpHorizontalSlideOutMenu( document.getElementById( 'main-nav-wrap' ) );
  </script>
</body>
</html>